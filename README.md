# 🐍 高级贪吃蛇游戏 - React Monorepo

一个功能丰富的贪吃蛇游戏，使用 **React + TypeScript + Monorepo + pnpm** 构建。

## 🎮 游戏特性

### 核心功能
- ✅ **经典贪吃蛇玩法**：移动、吃食物、成长
- ✅ **多难度等级**：简单(200ms)、中等(150ms)、困难(100ms)、极限(60ms)
- ✅ **暂停/继续**：随时暂停游戏
- ✅ **本地存储**：最高分持久化记录

### 高级功能
- ✅ **音效系统**：Web Audio API 生成音效
- ✅ **震动反馈**：设备震动支持
- ✅ **触控支持**：移动端滑动控制
- ✅ **穿墙模式**：可选的边界穿越
- ✅ **道具系统**：
  - ⚡ **加速**：1.5倍速，持续5秒
  - 🐌 **减速**：0.7倍速，持续5秒
  - 2x **双倍**：双倍分数，持续5秒
  - 🛡️ **护盾**：免疫碰撞，持续5秒
- ✅ **连击系统**：连续吃食物获得额外分数加成
- ✅ **视觉反馈**：彩色道具、护盾效果、方向眼睛
- ✅ **游戏覆盖层**：精美的开始、暂停、结束界面

## 🏗️ 项目结构

```
snake-game-monorepo/
├── packages/
│   ├── snake-core/          # 核心游戏逻辑包
│   │   ├── src/
│   │   │   ├── types.ts     # TypeScript 类型定义
│   │   │   ├── utils.ts     # 工具函数
│   │   │   ├── audio.ts     # 音效管理器
│   │   │   └── snake-game.ts # 游戏引擎
│   ├── snake-ui/            # UI 组件包
│   │   ├── src/
│   │   │   ├── GameCanvas.tsx   # 游戏画布
│   │   │   ├── GameStats.tsx    # 统计面板
│   │   │   ├── GameControls.tsx # 控制面板
│   │   │   ├── TouchControls.tsx # 触控支持
│   │   │   └── GameOverlay.tsx  # 游戏覆盖层
│   └── snake-game/          # 主应用包
│       ├── src/
│       │   ├── App.tsx      # 根组件
│       │   └── main.tsx     # 入口文件
├── package.json             # 根配置
├── pnpm-workspace.yaml      # pnpm 工作区
├── turbo.json               # 构建配置
└── README.md                # 项目文档
```

## 🚀 快速开始

### 前置要求
- Node.js >= 18
- pnpm >= 9

### 安装依赖
```bash
pnpm install
```

### 开发模式
```bash
pnpm dev
```

### 构建生产版本
```bash
pnpm build
```

### 类型检查
```bash
pnpm type-check
```

## 🎯 游戏控制

### 键盘控制
| 按键 | 功能 |
|------|------|
| `↑` `↓` `←` `→` | 方向控制 |
| `W` `A` `S` `D` | WASD 控制 |
| `空格` | 暂停/继续/开始 |

### 触控控制
- **滑动**：控制蛇的移动方向
- **点击**：暂停/继续游戏

### 鼠标控制
- **拖拽**：模拟滑动控制
- **点击**：暂停/继续游戏

## 🎲 游戏机制

### 难度等级
| 难度 | 速度 | 特点 |
|------|------|------|
| **简单** | 200ms | 适合新手，节奏缓慢 |
| **中等** | 150ms | 标准难度，平衡体验 |
| **困难** | 100ms | 快速反应，挑战性高 |
| **极限** | 60ms | 极速挑战，高手专属 |

### 道具系统
- **收集道具**：随机生成彩色方块
- **效果持续**：5秒
- **道具类型**：
  - 蓝色：加速移动
  - 紫色：减速移动
  - 黄色：双倍分数
  - 青色：护盾保护

### 分数计算
- **基础分数**：10分/食物
- **连击加成**：连续吃食物，最高5倍
- **双倍效果**：道具期间分数翻倍
- **道具奖励**：50分/道具

## 🔧 技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 18.2 | UI 框架 |
| TypeScript | 5.6 | 类型系统 |
| Vite | 5.0 | 构建工具 |
| pnpm | 9.15 | 包管理器 |
| Web Audio API | - | 音效生成 |
| Navigator Vibrate | - | 震动反馈 |

## 📦 开发脚本

```bash
# 各包独立脚本
pnpm --filter @snake/core build    # 构建核心包
pnpm --filter @snake/ui build      # 构建 UI 包
pnpm --filter snake-game dev       # 运行主应用

# 项目级脚本
pnpm install        # 安装所有依赖
pnpm dev            # 启动开发服务器
pnpm build          # 构建所有包
pnpm type-check     # 类型检查
```

## 🎨 设计亮点

### 1. Monorepo 架构
- **模块化**：核心逻辑、UI 组件、应用层分离
- **可复用**：核心包可在多个项目中使用
- **独立版本**：各包可独立发布
- **依赖优化**：pnpm workspace 减少重复

### 2. 音效系统
- **Web Audio API**：无需外部音频文件
- **动态生成**：实时合成音效
- **可配置**：用户可开关音效
- **震动反馈**：移动端触觉反馈

### 3. 触控优化
- **手势识别**：滑动方向检测
- **点击支持**：暂停/继续操作
- **响应式**：适配移动端
- **鼠标兼容**：桌面端也可使用

### 4. UI/UX
- **覆盖层设计**：精美的模态窗口
- **动画效果**：淡入、缩放动画
- **状态指示**：颜色编码的状态
- **实时反馈**：统计面板实时更新

## 🔍 性能优化

1. **React.memo**：减少组件重渲染
2. **requestAnimationFrame**：优化游戏循环
3. **状态去重**：避免不必要的更新
4. **内存管理**：组件卸载时清理
5. **代码分割**：Vite 自动 chunk 分离

## 📝 开发笔记

### 遇到的挑战
1. **Monorepo 路径解析**：Vite 别名配置
2. **类型冲突**：导入类型与组件名称冲突
3. **setTimeout 类型**：跨平台兼容性
4. **JSX 语法**：嵌套花括号解析

### 解决方案
- 使用 `path.resolve()` 解决路径
- 类型重命名避免冲突
- `ReturnType<typeof setTimeout>` 兼容
- 仔细检查 JSX 语法

## 🚀 未来扩展

### 可能的功能
- [ ] 多人对战模式
- [ ] 网络排行榜
- [ ] 回放系统
- [ ] 自定义皮肤
- [ ] 音效和背景音乐
- [ ] AI 对手模式
- [ ] 关卡编辑器

### 技术优化
- [ ] WebAssembly 性能优化
- [ ] Service Worker 离线支持
- [ ] PWA 应用
- [ ] 更好的状态管理

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📄 许可证

MIT License

---

**项目完成时间**: 2025-12-25
**版本**: v2.0
**状态**: ✅ 生产就绪